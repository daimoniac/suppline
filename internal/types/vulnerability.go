package types

import "time"

// Vulnerability represents the canonical vulnerability type used across the application.
// This is the single source of truth for vulnerability data structures.
type Vulnerability struct {
	ID           string // CVE ID
	Severity     string // CRITICAL, HIGH, MEDIUM, LOW
	PackageName  string
	Version      string // Installed version
	FixedVersion string // Version with fix (empty if no fix available)
	Title        string
	Description  string
	PrimaryURL   string // Reference URL
}

// VulnerabilityRecord extends Vulnerability with image context for storage.
// Used by StateStore to track which images contain which vulnerabilities.
// Note: This uses explicit fields instead of embedding to match statestore naming conventions.
type VulnerabilityRecord struct {
	CVEID            string // CVE ID
	Severity         string // CRITICAL, HIGH, MEDIUM, LOW
	PackageName      string
	InstalledVersion string // Installed version
	FixedVersion     string // Version with fix (empty if no fix available)
	Title            string
	Description      string
	PrimaryURL       string // Reference URL
	// Image context
	Repository string
	Tag        string
	Digest     string
	ScannedAt  time.Time
}
